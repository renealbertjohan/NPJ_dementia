library(RNAAgeCalc)
# browseVignettes("RNAAgeCalc")
library(curl)
library(biomaRt)
# browseVignettes("RNAAgeCalc")
install.packages("curl")
library(biomaRt)
library(RNAAgeCalc)
## Load libraries
BiocManager::install("RNAAgeCalc")
## Load libraries
BiocManager::install("RNAAgeCalc", force = TRUE)
## Load libraries
BiocManager::install("RNAAgeCalc", force = TRUE, dependencies = TRUE)
library(biomaRt)
## Load libraries
library(RCurl)
options(RCurloptions = list(http.version=HTTP_VERSION_1_0))
library(biomaRt)
library(curl)
## Load libraries
library(RCurl)
options(RCurloptions = list(http.version=HTTP_VERSION_1_0))
library(RNAAgeCalc)
library(curl)
install.packages("curl")
library(curl)
library(curl)
load("~/Desktop/heroes_uvic/2_Scripts/Environments/2_RNAAgeCalc.RData")
# Load libraries
library(biomaRt)
library(RNAAgeCalc)
library(tidyverse)
library(ggpubr) # For function stat_compare_means
library(ggh4x) # For function facet_grid2
library(ggtext) # For adding text to figure, if wanted/needed
library(rstatix) # For tukeyhsd() function in figures
# Results option 1: FPKM (biomaRt) or option 2: FPKM (internal data base)
resultAGE # Option 1
# Warning message:
# In count2FPKM(exprdata, genelength = genelength, idtype = idtype) :
# Can't find gene length for 44.2697% genes when converting raw count to FPKM.
?predict_age
resultAGE_2 # Option 2
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage, idtype = "SYMBOL", stype = "caucasian",
signature = "DESeq2") # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
# Results option 1: FPKM (biomaRt) or option 2: FPKM (internal data base)
resultAGE # Option 1
chronage
head(chronage)
# Extract the chronological age
chronage_2 <- data.frame(Sample_id = colnames(countsFPKM), Age = phenoHEROES$Age)
head(chronage_2)
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage_2, idtype = "SYMBOL", stype = "caucasian",
signature = "DESeq2", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
countsFPKM
colnames(countsFPKM)
chronage_2[,1]
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage_2, idtype = "SYMBOL", stype = "caucasian",
signature = "DESeq2", maxp = 30000, signature = "DESeq2") # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage_2, idtype = "SYMBOL", stype = "caucasian",
signature = "all", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage_2, idtype = "SYMBOL", stype = "caucasian",
signature = "GenAge", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage_2, idtype = "SYMBOL", stype = "caucasian",
signature = "DESeq2", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
# Check FKPM object
head(FPKM)
counts_length
row.names(FPKM) <- FPKM$ensembl_gene_id
FPKM <- FPKM[,c(2:21,30)]
FPKM$transcript_length <- as.numeric(FPKM$transcript_length) # Have to make the transcript_length numeric
# Check FKPM object
head(FPKM)
dim(FPKM)
# Step 3: RNAAge Calculation ----------------------------------------------
# Option 1: RNAAgeCalc with FPKM ------------------------------------------
# To perform FPKM (for paired-end reads) or RPKM (for single-end reads),
# We first divide by the library size and then by gene length (i.e., transcript_length).
# Notice that the sum of each sample after FPKM normalization is different.
FPKM <- counts_length
counts_length
row.names(FPKM) <- FPKM$ensembl_gene_id
FPKM <- FPKM[,c(2:21,30)]
FPKM$transcript_length <- as.numeric(FPKM$transcript_length) # Have to make the transcript_length numeric
# Check FKPM object
head(FPKM)
dim(FPKM)
# Step 1: normalize for read depth and multiply by million
FKPM2 <- apply(FPKM[,1:20], 2, function(x) x / sum(x) * 10^6)
# Step 2. scale by gene length and multiply by thousand
countsFPKM <- FKPM2 / FPKM$transcript_length * 10^3
# Check if rownames(phenoHEROES) and colnames(countsFPKM) are identical, including order
identical(phenoHEROES$Tube_code, colnames(countsFPKM))
# Extract the chronological age
chronage <- data.frame(Sample_id = colnames(countsFPKM), Age = phenoHEROES$Age)
# Calculate RNAAge with predictage from the FPKM counts matrix
set.seed(123456)
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage, idtype = "SYMBOL", stype = "caucasian",
signature = "DESeq2", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage, idtype = "ENSEMBL", stype = "caucasian",
signature = "DESeq2", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
counts_length
# Step 3: RNAAge Calculation ----------------------------------------------
# Option 1: RNAAgeCalc with FPKM ------------------------------------------
# To perform FPKM (for paired-end reads) or RPKM (for single-end reads),
# We first divide by the library size and then by gene length (i.e., transcript_length).
# Notice that the sum of each sample after FPKM normalization is different.
FPKM <- counts_length
row.names(FPKM) <- FPKM$X
FPKM <- FPKM[,c(2:21,30)]
FPKM$transcript_length <- as.numeric(FPKM$transcript_length) # Have to make the transcript_length numeric
# Check FKPM object
head(FPKM)
dim(FPKM)
# Step 1: normalize for read depth and multiply by million
FKPM2 <- apply(FPKM[,1:20], 2, function(x) x / sum(x) * 10^6)
# Step 2. scale by gene length and multiply by thousand
countsFPKM <- FKPM2 / FPKM$transcript_length * 10^3
# Check if rownames(phenoHEROES) and colnames(countsFPKM) are identical, including order
identical(phenoHEROES$Tube_code, colnames(countsFPKM))
# Extract the chronological age
chronage <- data.frame(Sample_id = colnames(countsFPKM), Age = phenoHEROES$Age)
# Extract the chronological age
chronage <- data.frame(Sample_id = colnames(countsFPKM), Age = phenoHEROES$Age)
# Calculate RNAAge with predictage from the FPKM counts matrix
set.seed(123456)
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage, idtype = "SYMBOL", stype = "caucasian",
signature = "DESeq2", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage, idtype = "SYMBOL", stype = "caucasian",
signature = "DESeq2", maxp = 100000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage, idtype = "SYMBOL", stype = "caucasian",
signature = "DESeq2", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage, idtype = "SYMBOL", stype = "caucasian",
signature = "Pearson", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage, idtype = "SYMBOL", stype = "caucasian",
signature = "DESeq2", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
# Extract the chronological age
chronage <- data.frame(sampleid = colnames(countsFPKM), age = phenoHEROES$Age)
# Calculate RNAAge with predictage from the FPKM counts matrix
set.seed(123456)
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage, idtype = "SYMBOL", stype = "caucasian",
signature = "DESeq2", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage, idtype = "SYMBOL", stype = "caucasian",
signature = "DESeq2", maxp = 30000)
resultAGE
Control <- as.vector(phenoHEROES[phenoHEROES$Status == "Control",]$Tube_code)
PDD <- phenoHEROES[phenoHEROES$Status == "PDD", ]$Tube_code
AD <- phenoHEROES[phenoHEROES$Status == "AD", ]$Tube_code
DSD <- phenoHEROES[phenoHEROES$Status == "DSD", ]$Tube_code
# Hippocampus
Control_HC <- Control[grep("HC_", Control)]
PDD_HC <- PDD[grep("HC_", PDD)]
AD_HC <- AD[grep("HC_", AD)]
DSD_HC <- DSD[grep("HC_", DSD)]
AGE_Control_HC <- resultAGE[row.names(resultAGE) %in% Control_HC,]
AGE_PDD_HC <- resultAGE[row.names(resultAGE) %in% PDD_HC,]
AGE_AD_HC <- resultAGE[row.names(resultAGE) %in% AD_HC,]
AGE_DSD_HC <- resultAGE[row.names(resultAGE) %in% DSD_HC,]
AGE_Control_HC
AGE_PDD_HC
AGE_AD_HC
AGE_DSD_HC
makeplot(AGE_Control_HC)
makeplot(AGE_PDD_HC)
makeplot(AGE_AD_HC)
makeplot(AGE_DSD_HC)
makeplot(AGE_Control_HC)
makeplot(AGE_PDD_HC)
makeplot(AGE_AD_HC)
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage, idtype = "SYMBOL",
signature = "DESeq2", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
resultAGE
resultAGE <- predict_age(exprdata = countsFPKM, tissue = "brain", exprtype = "FPKM",
chronage = chronage, idtype = "SYMBOL", stype = "caucasian",
signature = "DESeq2", maxp = 30000) # 6.5539% genes in the gene signature are not included in the supplied gene expression (imputed).
RNAAGECAL
RNAAGECAL[RNAAGECAL$Status == "AD",]
RNAAGECAL[RNAAGECAL$Status == "AD" & RNAAGECAL$Timepoint == "RNAAge",]
RNAAGECAL[RNAAGECAL$Status == "AD" & RNAAGECAL$Timepoint == "RNAAge", "Age"]
mean(RNAAGECAL[RNAAGECAL$Status == "AD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
# Calculations
# Control
mean(RNAAGECAL[RNAAGECAL$Status == "Control" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
sd(RNAAGECAL[RNAAGECAL$Status == "Control" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
# Calculations
# Control
mean(RNAAGECAL[RNAAGECAL$Status == "Control" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
sd(RNAAGECAL[RNAAGECAL$Status == "Control" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
# PDD
mean(RNAAGECAL[RNAAGECAL$Status == "PDD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
sd(RNAAGECAL[RNAAGECAL$Status == "PDD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
# AD
mean(RNAAGECAL[RNAAGECAL$Status == "AD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
sd(RNAAGECAL[RNAAGECAL$Status == "AD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
# DSD
mean(RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
sd(RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
mean(RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "ChronAge", "Age"])
bio <- mean(RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
chron <- mean(RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "ChronAge", "Age"])
bio -chron
bio <- mean(RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
chron <- mean(RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "ChronAge", "Age"])
bio - chron
counts_length
phenoHEROES
bio - chron
# Calculations
# Control
mean(RNAAGECAL[RNAAGECAL$Status == "Control" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
sd(RNAAGECAL[RNAAGECAL$Status == "Control" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
# PDD
mean(RNAAGECAL[RNAAGECAL$Status == "PDD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
sd(RNAAGECAL[RNAAGECAL$Status == "PDD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
library(disgenetplus2r) # DisGeNet Plus
sessionInfo()
# DSD
mean(RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
sd(RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
bio <- mean(RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "RNAAge", "Age"])
chron <- mean(RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "ChronAge", "Age"])
bio - chron
bio
RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "RNAAge", "Age"]
RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "ChronAge", "Age"]
RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "RNAAge", "Age"] - RNAAGECAL[RNAAGECAL$Status == "DSD" & RNAAGECAL$Timepoint == "ChronAge", "Age"]
phenoHEROES
phenoHEROES[phenoHEROES$Status == "DSD",]
